"""
This script generates a CSV file with 100 travel requests for Use Case 1.
The travel requests are generated by sampling 100 rows from the 'places_metadata.xlsx' file.
Each travel request is a string that includes a random duration (a weekend or 1 week) and a destination country.
The generated CSV file is saved as 'travel_requests.csv'.
"""

import pandas as pd
import random

# Read the data from an Excel file
file_path = 'datasets/places_metadata.xlsx'
df = pd.read_excel(file_path)

# Drop duplicates to create a DataFrame with unique (Continent, Country) pairs
unique_df = df.drop_duplicates(subset=['Continent', 'Country'])
print(len(unique_df))

# Sample 100 rows from the DataFrame (allowing duplicates)
sampled_df = df.sample(n=100, replace=False, random_state=42)

# Define possible durations
durations = ["a weekend", "1 week"]

# Add a new column with the plan request
sampled_df['Plan Request'] = sampled_df['Country'].apply(
    lambda destination: f"Give me a plan for {random.choice(durations)} to {destination}"
)
sampled_df = sampled_df[['Continent', 'Country', 'Plan Request']]
sampled_df = sampled_df.sort_values(by=['Continent', 'Country'])

# Save the sampled DataFrame to a CSV file
output_file_path = 'datasets/test_requests_for_UseCase1/travel_requests.csv'
sampled_df.to_csv(output_file_path, index=False)

print(f"Sampled data saved to {output_file_path}")